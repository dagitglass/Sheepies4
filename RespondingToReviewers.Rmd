---
title: "RespondingToReviewers"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

balenvvisitnozero <- ballenvvisit2[ballenvvisit2$NumIndSheep != 0,]




library(pscl)
negbintwovar <- zeroinfl(NumIndSheep ~ tmax..deg.c. + MeanNDVI + tmin..deg.c. + prcp..mm.day. | tmax..deg.c. + MeanNDVI + tmin..deg.c. + prcp..mm.day. + MtnRange, data = ballenvvisit2, dist = "negbin", link = "logit")
summary(negbintwovar)

negbintwovar1 <- zeroinfl(NumIndSheep ~ tmax..deg.c. + MeanNDVI + tmin..deg.c. | tmax..deg.c. + MeanNDVI + tmin..deg.c. + MtnRange, data = ballenvvisit2, dist = "negbin", link = "logit")
summary(negbintwovar1)

## NEW BEST MODEL 1/11/22
negbintwovar2 <- zeroinfl(NumIndSheep ~ tmax..deg.c. + MeanNDVI | tmax..deg.c. + MeanNDVI + MtnRange, data = ballenvvisit2, dist = "negbin", link = "logit")
summary(negbintwovar2)


negbintwovar2int <- zeroinfl(NumIndSheep ~ tmax..deg.c. + MeanNDVI + tmax..deg.c. * MeanNDVI | tmax..deg.c. + MeanNDVI + tmax..deg.c. * MeanNDVI + MtnRange, data = ballenvvisit2, dist = "negbin", link = "logit")
summary(negbintwovar2int)
# computationally singular

vuong(negbintwovar, twovar)
vuong(negbintwovar2, twovar1)

hurdtwovar <- hurdle(NumIndSheep ~ tmax..deg.c. + MeanNDVI + tmin..deg.c. + prcp..mm.day. | tmax..deg.c. + MeanNDVI + tmin..deg.c. + prcp..mm.day. + MtnRange, data = ballenvvisit2, dist = "poisson", link = "logit")
summary(hurdtwovar)

hurdtwovar1 <- hurdle(NumIndSheep ~ tmax..deg.c. + MeanNDVI + tmin..deg.c. | tmax..deg.c. + MeanNDVI + tmin..deg.c. + MtnRange, data = ballenvvisit2, dist = "poisson", link = "logit")
summary(hurdtwovar1)

vuong(twovar1, hurdtwovar1)

# From the Zuur book zero inflated chapter:
library(lmtest)
# these two models below have the same variable
lrtest(twovar1, negbintwovar1)

lrtest(negbintwovar1, twovar1)
lrtest(negbintwovar1, hurdtwovar1)


### Checking with 6 week precip 1/14/22
ballenvvisit4 <- ballenvvisit2
Precip6Wk <- read.csv("C:/Users/Danielle Glass/Documents/RWorkingDirectory3/Sheepies5/6WeekTotalPrecip.csv", sep = ",", header = TRUE)
ballenvvisitpre <- cbind(ballrangeenvvar, Precip6Wk$Week6TotalPrecip)
names(ballenvvisitpre)[names(ballenvvisitpre) == "MountainRange"] <- "MtnRange"
ballenvvisitpre1 <- merge(x = meanpercentbighorn2, y = ballenvvisitpre, all = TRUE)
ballenvvisitpre2 <- ballenvvisitpre1[with(ballenvvisitpre1, order(MtnRange, Date)), ]
ballenvvisitpre3 <- ballenvvisitpre2[complete.cases(ballenvvisitpre2), ]
names(ballenvvisitpre3)[names(ballenvvisitpre3) == "Precip6Wk$Week6TotalPrecip"] <- "Precip6Wk"

# Modeling
library(pscl)

# Model with tmax, NDVI, tmin, precip, 6Wk precip works
prmd <- zeroinfl(NumIndSheep ~ tmax..deg.c. + MeanNDVI + tmin..deg.c. + prcp..mm.day. + Precip6Wk | tmax..deg.c. + MeanNDVI + tmin..deg.c. + prcp..mm.day. + Precip6Wk + MtnRange, data = ballenvvisitpre3, dist = "negbin", link = "logit")
summary(prmd)

# Minus precip
prmd1 <- zeroinfl(NumIndSheep ~ tmax..deg.c. + MeanNDVI + tmin..deg.c. + Precip6Wk | tmax..deg.c. + MeanNDVI + tmin..deg.c. + Precip6Wk + MtnRange, data = ballenvvisitpre3, dist = "negbin", link = "logit")
summary(prmd1)

# Minus tmin -- best model 1/14/22
prmd2 <- zeroinfl(NumIndSheep ~ tmax..deg.c. + MeanNDVI + Precip6Wk | tmax..deg.c. + MeanNDVI + Precip6Wk + MtnRange, data = ballenvvisitpre3, dist = "negbin", link = "logit")
summary(prmd2)

# Comparing against poisson model
prmd2poi <- zeroinfl(NumIndSheep ~ tmax..deg.c. + MeanNDVI + Precip6Wk | tmax..deg.c. + MeanNDVI + Precip6Wk + MtnRange, data = ballenvvisitpre3, dist = "poisson", link = "logit")
summary(prmd2poi)

lrtest(prmd2, prmd2poi)
# Negative binomial is better

# Running the model with scaled variables to see which one has the biggest effect

scballpre3 <- ballenvvisitpre3
scballpre3$scaletmax <- scale(scballpre3$tmax..deg.c., center = TRUE, scale = TRUE)
scballpre3$scaleMeanNDVI <- scale(scballpre3$MeanNDVI, center = TRUE, scale = TRUE)
scballpre3$scaleprecip6wk <- scale(scballpre3$Precip6Wk, center = TRUE, scale = TRUE)

scaleprmd <- zeroinfl(NumIndSheep ~ scaletmax + scaleMeanNDVI + scaleprecip6wk | scaletmax + scaleMeanNDVI + scaleprecip6wk + MtnRange, data = scballpre3, dist = "negbin", link = "logit")
summary(scaleprmd)
pR2(scaleprmd)

```


